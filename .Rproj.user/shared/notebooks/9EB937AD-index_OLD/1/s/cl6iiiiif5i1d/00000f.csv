"0","# Master Trap Summary ----"
"0","## Trap Effort ----"
"0","covid <- data.frame(Year = c(2020, 2021, 2023), "
"0","                    Period = c(""COVID"",""COVID"", ""DFO Strike""),"
"0","                    Date   = c(NA,NA,NA),"
"0","                    binary = c(0,0,0))"
"0",""
"0","trap_effort <- all_dat %>% "
"0","               group_by(Year, Period, Date) %>%"
"0","               summarize(binary = 1) %>%"
"0","               ungroup() %>%"
"0","               rbind(covid) %>%"
"0","               group_by(Year, Period) %>%"
"0","               summarize(trap_days = sum(binary),"
"0","                         start = format(min(Date), ""%b-%d""),"
"0","                         end   = format(max(Date),""%b-%d"")) %>%"
"0","               filter(complete.cases(Period))"
"0",""
"0","trap_effort_table <- trap_effort %>%"
"0","               pivot_wider(names_from = Period, values_from = c(trap_days, start, end)) %>%"
"0","               select(Year, trap_days_Spring, start_Spring, end_Spring,trap_days_Fall, start_Fall, end_Fall) %>%"
"0","               mutate(start_Spring = ifelse(c(Year == 2020 | Year == 2021), ""COVID"","
"0","                                            ifelse(Year == 2023, ""DFO Strike"",start_Spring)),"
"0","                      trap_days_Spring = coalesce(trap_days_Spring,0),"
"0","                      trap_days_Fall   = coalesce(trap_days_Fall,0)) "
"0",""
"0","## Prepare Plot Data"
"0","trap_plot <- all_dat %>%"
"0","               mutate(date.std    = case_when(year(Date) >= 0 ~ 'year<-'(Date, 2024))) %>%"
"0","               drop_na(Period) %>%"
"0","               group_by(Year, Period, date.std) %>%"
"0","               summarize(binary = 1) %>%"
"0","               ungroup() %>%"
"0","               group_by(Period,date.std) %>%"
"0","               summarize(n = sum(binary),"
"0","                         nyears = 14,"
"0","                         mean  = n/nyears) "
"0","          "
"0","  ## Make Plots "
"0","  "
"0",""
"0","   spring.trap.plot <- ggplot(trap_plot[trap_plot$Period==""Spring"",]) + "
"0","                              geom_col(aes(x= date.std, y = mean))+"
"0","                              labs(x = """", y = ""Proportion of Days Sampled (%)"") +"
"0","                              scale_y_continuous(breaks = seq(0,1,0.2)) +"
"0","                              scale_x_date(date_breaks = ""1 week"","
"0","                                           date_minor_breaks = ""1 day"","
"0","                                           date_labels = ""%b-%d"") +"
"0","                              # facet_grid(.~Period, scale = ""free_x"") +"
"0","                              theme_bw()"
"0","             "
"0","   fall.trap.plot <- ggplot(trap_plot[trap_plot$Period==""Fall"",]) + "
"0","                              geom_col(aes(x= date.std, y = mean))+"
"0","                              labs(x = """", y = ""Proportion of Days Sampled (%)"") +"
"0","                              scale_y_continuous(breaks = seq(0,1,0.2)) +"
"0","                              scale_x_date(date_breaks = ""1 week"","
"0","                                           date_minor_breaks = ""1 day"","
"0","                                           date_labels = ""%b-%d"") +"
"0","                              # facet_grid(.~Period, scale = ""free_x"") +"
"0","                              theme_bw()"
"0","             "
