---
title: "SimmsFishFence"
author: "Eric V"
date: "`r Sys.Date()`"
output:
  html_document:
    fig_caption: yes
    code_folding: show
    toc: yes
    toc_float: yes
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: scroll
  html_notebook:
    toc: yes
  word_document:
    toc: yes
editor_options:
  chunk_output_type: inline

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

```

# 1. Introduction

Simms Creek is a small, 3rd order stream that drains an area of \~1,800 ha into the Salish Sea, near Campbell River's Willow Point neighborhood. The lower reach of Simms Creek (\~3 km of channel, east of Jubilee Road), is contained within a narrow urban green way that is bordered by residential properties. From Jubilee Road to the Inland Highway the stream is protected within [Beaver Lodge Lands](https://campbellriver.travel/news/forestry-guide-to-beaver-lodge-lands/), upstream of the Inland Highway, \>1.5 km of tributary channel is located within private forest lands.

Historic fish observations indicate that Chum, Chinook, Pink and Coho Salmon have all been observed in the stream, as well as Coastal Cutthroat Trout, Rainbow Trout and Steelhead. More recent monitoring (aka this dataset), suggest that Coho Salmon and Coastal Cutthroat Trout are the primary species within Simms Creek, both of which utilize the stream year round - though a small number of juvenile Chinook Salmon were identified in 2024.

[Greenways Land Trust](https://www.greenwaystrust.ca/) has supported Simms Creek Stewards for +20 years, including operation of a fish fence near the mouth of the stream since 2008. Juvenile and adult fish moving past the fence are tallied each spring and fall, respectively. The objective of this project is to explore the juvenile fence dataset. All work is being done strictly for fun and out of personal curiosity. Any feedback, input, or support is welcome. Also, I have a soft spot for Coastal Cutthroat Trout (CCT), so be warned that effort may be slightly trout biased.

Throughout this analysis, I will aim to answer the following questions:

1.  What species are utilizing Simms Creek?

2.  Is current fence operation program capturing the complete migration period?

3.  For each species, when are key behaviours occuring (e.g., when is peak smolt? when do adults arrive?).

4.  How large are fish encountered during smolt and upstream migration periods? What age classes are migrating (I don't have scale data, but we can make an educated guess).

5.  What is the freshwater survival of Coho Salmon? Note that we cannot estimate marine survival without some information on individual fish (i.e., coded wire tag data to verify that returning adults originated in Simms Creek and when they smolted).

6.  What proportion of returning Coho Salmon are hatchery origin? Have any hatchery origin trout been encountered (not actually sure if there are many hatchery reared trout at the moment, and if so, if they are marked).

7.  What factors may be contributing to observed trends in abundance?

But before we can do that, lets take a look at what has been completed to date. It's a tremendous amount of work and all volunteers and supporters should be commended!

```{r 1. Load and Format Data, echo = FALSE, warning = FALSE, message = FALSE}
## Clear workspace ##
# rm(list = ls())  

# ## Load Prepped Data
 # source("SourceFiles/0. RunSourceFiles.R")
# 
  source("SourceFiles/1. Load and Prep Data.R")
# 
# ## Load Trap Effort Data
 source("SourceFiles/2. Trapping Effort.R")

```

# 2. Spring Fence Operation

### 2.1. Monitoring Effort
The Simms Creek fish fence has operated annually since 2008, with the exception of 2020 and 2021 when operations were paused due to the COVID-19 Pandemic and in the spring of 2023 when federal employees were on strike.

Spring surveys target out migrating juvenile Coho Salmon but also capture an impressive number of Coastal Cutthroat Trout and have even captured some Chinook Salmon. Spring fence monitoring has started as early as `r format(min(trap_plot$date.std[trap_plot$Period=="Spring"]), "%B %d")`, however, most surveys (50%) don't start until `r format(min(trap_plot$date.std[trap_plot$Period=="Spring" & trap_plot$prop.sampled >= 0.5]), "%B %d")`. In each monitoring year, the fence has operated continuously (e.g., sampling occurred at least daily) from `r format(min(trap_plot$date.std[trap_plot$Period=="Spring" & trap_plot$prop.sampled == 1.0]), "%B %d")` to `r format(max(trap_plot$date.std[trap_plot$Period=="Spring" & trap_plot$prop.sampled == 1.0]), "%B %d")`. Surveys have continued as late as `r format(max(trap_plot$date.std[trap_plot$Period=="Spring"]), "%B %d")`, but most (50%) are terminated by `r format(max(trap_plot$date.std[trap_plot$Period=="Spring" & trap_plot$prop.sampled==0.5]), "%B %d")`.



```{r 2. Trap Effort Table trap effort table, fig.cap = "Table 1. Annual spring and fall trap operation periods.", fig.topcaption = TRUE, echo=FALSE, warning=FALSE, message = FALSE}

## Kable - Master Summary ----
options(knitr.kable.NA = '-')
    

    kable(trap_effort_table,
      "html",
      booktabs = T,
      
      align = c("c"),
      col.names = c("Year", "# Days Sampled", "Start", "End", 
                            "# Days Sampled", "Start", "End"),
      caption = "Table 1. Annual spring and fall trap operation periods.",
      
      digits = 1) %>%
  column_spec(c(2,5), width = "2cm") %>%
  kable_styling("striped", full_width =  FALSE,
                position = "center", 
                font_size = 12,
                fixed_thead = TRUE) %>%
  add_header_above(c(" " = 1, "Spring Sampling" = 3, "Fall Sampling" = 3))
```

```{r 2. Trap Effort - Spring Plot, echo=FALSE, warning=FALSE, message = FALSE, fig.width = 15, fig.height = 5, fig.cap = "Figure 1. Spring juvenile trap operation effort, presented as the proportion of sample years when trapping was completed on each date.", fig.topcaption = TRUE}

print(trap_effort_plot_spring)

```

<!-- **`r fig_nums("spring.trap.plot", "Spring trap operation period, presented as the proportion of sample years each date has been trapped since 2008 (excluding years when trapping did not occur due to COVID or government strikes).")`** -->

```{r 2. Trap Effort - Fall Plot, fig.topcaption = TRUE, echo=FALSE, warning=FALSE, message = FALSE, fig.width = 15, fig.height = 5, fig.cap = "Figure 2. Fall adult trapping effort, presented as the proportion of sample years when trapping was completed on each date."}

print(trap_effort_plot_fall)

```

<!-- **`r fig_nums("fall.trap.plot", "Fall trap operation period, presented as the proportion of sample years each date has been trapped since 2008 (excluding years when trapping did not occur due to COVID or government strikes).")`** -->



```{r 3. Stream Conditions - Load Data, echo=FALSE, warning=FALSE, message = FALSE}

## Load Stream Conditions Data 
 source("SourceFiles/3. Stream Conditions.R")

```

### 2.2 Stream Conditions

During each daily trap visit, volunteers record measures of water temperature, pH, Total Suspended Sediment (TSS), dissolved oxygen, and water level (stage). Mean annual measures of each parameter are presented below for the Spring monitoring period (Table 2 and Figure 3). 

```{r 3. Stream Conditions - Spring Table, fig.cap = "Table 2. Overall annual stream conditions during spring trap monitoring from 2008 to 2024.", fig.topcaption = TRUE,echo=FALSE, warning=FALSE, message = FALSE}

cond_data_wide.spring <- cond_data_wide %>% select(1:13)

## Kable - Stream Conditions ----
options(knitr.kable.NA = '-')
    

    kable(cond_data_wide.spring,
      "html",
      booktabs = T,
      
      align = c("c"),
      col.names = c(" ", "Mean","SD","Mean","SD","Mean","SD","Mean","SD","Mean","SD","Mean","SD"),
      caption = "Table 2. Stream conditions during spring trap operation.",
      
      digits = 1) %>%
  column_spec(c(2,5), width = "2cm") %>%
  kable_styling("striped", full_width =  FALSE,
                position = "center", 
                font_size = 12,
                fixed_thead = TRUE) %>% 
  add_header_above(c(" " = 1, "Air Temp. \n(\u00B0C)" = 2, "Water Temp. \n(\u00B0C)" = 2, 
                              "pH \n. " = 2, "DO \n(mg/L)" = 2, "TDS \n(ppm)" = 2, "Water Level \n(m)" = 2)) %>%
  add_header_above(c("Year"= 1, "Spring Monitoring" = 12))    

```


```{r 3. Stream Conditions - Plot, echo=FALSE, warning=FALSE, message = FALSE, fig.width = 10, fig.height = 15, fig.cap = "Figure 3. Average daily measures of air and water temperature, pH, dissolved oxygen (DO), total dissolved solids (TDS) and water level (stage).", fig.topcaption = TRUE}

print(cond_plot)
```

### 2.3. Annual Captures

```{r 4. Fish Captures - Summary Table catch_dat.prep, echo=FALSE, warning=FALSE, message = FALSE, include = FALSE}
source("SourceFiles/4. Annual Captures.R")
```

Since 2008, a total of `r format(sum(catch_annual.Table.Spring$nCT), big.mark =",")` juvenile Coastal Cutthroat Trout and `r format(sum(catch_annual.Table.Spring$nCO), big.mark =",")` juvenile Coho Salmon have been captured during spring trapping. Annual captures of CCT have ranged from `r format(min(catch_annual.Table.Spring$nCT), big.mark =",")` to `r format(max(catch_annual.Table.Spring$nCT), big.mark =",")` (mean = `r format(mean(catch_annual.Table.Spring$nCT), digits = 1)`) while CO captures have varied from `r format(min(catch_annual.Table.Spring$nCO), big.mark =",")` to `r format(max(catch_annual.Table.Spring$nCO), big.mark =",")` with an overall mean of `r format(mean(catch_annual.Table.Spring$nCO), digits = 1)`) fish (Figure 4 and Table 4).

```{r 4. Annual Captures - Summary Plot, fig.cap = "Figure 4. Total annual catch of Coastal Cutthroat Trout and Coho Salmon during Spring fence monitoring.", fig.topcaption = TRUE, echo=FALSE, warning=FALSE, message = FALSE, fig.width = 10, fig.height = 12}

print(catch_annual_barPlot.Spring)
```

```{r Annual Captures - SummaryTable, echo=FALSE, warning=FALSE, message = FALSE}
## Kable - Master Summary ----
options(knitr.kable.NA = '-')

kable(catch_annual.Table.Spring,
      "html",
      booktabs = T,
      
      align = c("c"),
      # col.names = c("Year", "Period", "Start", "End", "# Days Sampled", 
      col.names = c("Year", "Start", "End", "# Days Sampled",  
                    "Med.","Min","Max", "n", "Mean", "SD" ,"Min","Max",
                    "Med.","Min","Max", "n", "Mean", "SD" ,"Min","Max"),
      caption = "**Table 4. Spring capture summary - capture timing, total captures and length of Coastal Cutthroat Trout and Coho Salmon.**",
      digits = 1) %>%
  #column_spec(c(1, 3,10,17), bold = TRUE) %>%
  kable_styling("striped", full_width =  FALSE,
                position = "center", 
                font_size = 12,
                fixed_thead = TRUE) %>%
  # add_header_above(c(" " = 2, "Sample Period" = 3, 
  add_header_above(c(" " = 1, "Sample Period" = 3,                   
                     "Capture Timing" = 3,"Fork Length (mm)" = 5,
                     "Capture Timing" = 3,"Fork Length (mm)" = 5)) %>%
  add_header_above(c(" " = 4, "Coastal Cutthroat Trout" = 8, "Coho Salmon" = 8)) 
```

### 2.4. Migration Timing

```{r 5. Capture Timing - Load Data, echo=FALSE, warning=FALSE, message = FALSE, include = FALSE}
 source("SourceFiles/5. Capture Timing.R")
```

```{r 5. Capture Timing - Prepare text values, echo=FALSE, warning=FALSE, message = FALSE, include = FALSE }

CT.first.detection.earliest <- format(min(pass.period.spring$minPass.min[pass.period.spring$Species=="CT"]), "%B %d")
CT.first.detection.latest   <- format(max(pass.period.spring$minPass.min[pass.period.spring$Species=="CT"]), "%B %d")
CT.first.detection.mean     <- format(mean(pass.period.spring$minPass.min[pass.period.spring$Species=="CT"], na.rm = TRUE), "%B %d")
CT.first.detection.SD       <- round(sd(pass.period.spring$minMeanDiff[pass.period.spring$Species=="CT"], na.rm = TRUE), 1)
CT.50p.mean                 <- format(mean(catch50prop.spring$meanDate50p[catch50prop.spring$Species=="CT"], na.rm = TRUE), "%B %d")
CT.50p.SD                   <- round(sd(catch50prop.spring$Date50pDiff[catch50prop.spring$Species=="CT"], na.rm = TRUE), 1)
CT.peak.mean                <- format(mean(catch_peak.spring$date.std_CT,na.rm = TRUE), "%B %d")
CT.peak.SD                  <- round(sd(catch_peak.spring$MeanDiff_CT,na.rm = TRUE),1)


CO.first.detection.earliest <- format(min(pass.period.spring$minPass.min[pass.period.spring$Species=="CO"]), "%B %d")
CO.first.detection.latest   <- format(max(pass.period.spring$minPass.min[pass.period.spring$Species=="CO"]), "%B %d")
CO.first.detection.mean     <- format(mean(pass.period.spring$minPass.min[pass.period.spring$Species=="CO"], na.rm = TRUE), "%B %d")
CO.first.detection.SD       <- round(sd(pass.period.spring$minMeanDiff[pass.period.spring$Species=="CO"], na.rm = TRUE), 1)
CO.50p.mean                 <- format(mean(catch50prop.spring$meanDate50p[catch50prop.spring$Species=="CO"], na.rm = TRUE), "%B %d")
CO.50p.SD                   <- round(sd(catch50prop.spring$Date50pDiff[catch50prop.spring$Species=="CO"], na.rm = TRUE), 1)
CO.peak.mean                <- format(mean(catch_peak.spring$date.std_CO,na.rm = TRUE), "%B %d")
CO.peak.SD                  <- round(sd(catch_peak.spring$MeanDiff_CO,na.rm = TRUE),1)

```

Outmigrating juvenile coastal cutthroat trout and Coho Salmon were first encountered at the trap over a similar period, from `r CT.first.detection.earliest` to `r CT.first.detection.latest` (mean $\pm$ SD = `r CT.first.detection.mean` $\pm$ `r CT.first.detection.SD` days) for cutthroat and  `r CO.first.detection.earliest` to `r CO.first.detection.latest` for Coho (mean $\pm$ SD = `r CO.first.detection.mean` $\pm$ `r CO.first.detection.SD` days). On average 50% of all cutthroat trout had passed the fence by `r CT.50p.mean`$\pm$ `r CT.50p.SD` days while half of Coho Salmon migrants had passed the fence by `r CO.50p.mean`$\pm$ `r CO.50p.SD` days. Despite similarities in when migrations started and the timing that most migrants had past the fence, there was a noticeable difference in the timing of peak migrations (the date when the greatest number of fish passed the fence). For Coastal Cutthroat, the overall mean $\pm$ SD peak migration occurred on `r CT.peak.mean`($\pm$ `r CT.peak.SD` days) whereas overall mean peak Coho Salmon migration occurred more than a week later on `r CO.peak.mean` ($\pm$ `r CO.peak.SD` days) (Figure 5). Total number of daily captures of Cutthroat Trout and Coho Salmon per year are presented in Figure 6 and Figure 7, respectively. 


```{r 5. Capture Timing - Peak Capture Histogram, fig.cap = "Figure 5. Histogram showing frequency of peak capture dates during Spring fence monitoring.", fig.topcaption = TRUE, echo=FALSE, warning=FALSE, message = FALSE, fig.width = 10, fig.height = 12}

 print(Catch_Peak_Plot.Spring)


```

```{r 5. Capture Timing - Daily CT Captures, fig.cap = "Figure 6. Number of Coastal Cutthroat Trout captured during each day of spring fence operation since 2008.", fig.topcaption = TRUE, echo=FALSE, warning=FALSE, message = FALSE, fig.width = 10, fig.height = 25}

print(daily_catch_plot.Spring.CT)
```

```{r 5. Capture Timing - Daily CO Captures, fig.cap = "Figure 7. Number of Coho Salmon captured during each day of spring fence operation since 2008.", fig.topcaption = TRUE, echo=FALSE, warning=FALSE, message = FALSE, fig.width = 10, fig.height = 25}

print(daily_catch_plot.Spring.CO)
```


##--------------------------

```{r exit}
knitr::knit_exit()
```

##--------------------------

```{r CCT - cum.Catch.plot,echo=FALSE, warning=FALSE, message = FALSE, fig.width = 9, fig.height = 15}

labels <- data.frame(Year = unique(Spring.Catch$Year), YYYEAR = unique(Spring.Catch$Year)) %>%
          # data.frame(Year = unique(CCT_catch$Year), YYYEAR = unique(CCT_catch$Year)) %>%
          mutate(YYYEAR = ifelse(Year == 2020, "2020 - COVID",
                                 ifelse(Year == 2021,"2021 - COVID",
                                        ifelse(Year == 2023, "2023 - Strike",Year))),
                 labX = as.Date(ifelse(Year == 2020, as.Date("2024-05-25"),
                                 ifelse(Year == 2021,as.Date("2024-05-25"),
                                        ifelse(Year == 2023, as.Date("2024-05-25"),as.Date("2024-04-16"))))))
ggplot(Spring.Catch) + 
      geom_col(aes(x= date.std, y =catch))+
      geom_line(aes(x= date.std, y = prop.scaled)) +
      geom_label(data = labels, aes(label = YYYEAR),
                x = as.Date("2024-04-15"), y = 205,
                hjust = "left", vjust = 0,
                inherit.aes = FALSE)+
      scale_x_date(date_breaks = "2 week", date_labels = "%b-%d") +
      scale_y_continuous("Total Captures (# of Fish)",
                         sec.axis = sec_axis(~./300, 
                         name = "Proportion of Total Catch (%)"))+
      facet_grid(Year~Species) +
      labs(x="", y = "Total Captures (# of Fish)") +
      theme_bw() +
      theme(strip.text.y = element_blank())
    
```

```{r CCT - cum.Catch.plot2,echo=FALSE, warning=FALSE, message = FALSE }
    ggplot(CCT_catch) +
        geom_line(aes(x= date.std, y = prop, color = Year)) +
        labs(x = "", y = "Proportion of Total Catch (%)") +
        scale_x_date(date_breaks = "1 week", 
                     minor_breaks = "1 day",
                     date_labels = '%b-%d')+ 
        facet_grid(Decade~.)+
        theme_bw() +
        theme(legend.position = "bottom")



```

```{r CT Catch Summary, echo=FALSE, warning=FALSE, message = FALSE}
### Prep Data ----
CT_catch <- catch_summary %>%
            select(1:13) %>%  # Select CT Data
            pivot_wider(names_from = Period, values_from = 3:13) %>%
            select(1, ends_with("Spring"), ends_with("Fall")) %>%
            ungroup() %>%
            add_row(Year = c(2020, 2021, 2023)) %>%
            arrange(Year)


## CT Kable ----
kable(CT_catch,
      "html",
      booktabs = T,
      align = c("c"),
      col.names = c("Year","Start", "End", "# Days Sampled",  
                    "n","Med.","Min","Max", "Mean", "SD" ,"Min","Max",
                    "Start", "End", "# Days Sampled",  
                    "n","Med.","Min","Max", "Mean", "SD" ,"Min","Max"),
      caption = "**Table 1. Spring and Fall Trapping of Coastal Cutthroat Trout.**",
      digits = 1) %>%
  #column_spec(c(1, 3,10,17), bold = TRUE) %>%
  kable_styling("striped", full_width =  FALSE,
                position = "center", 
                font_size = 12,
                fixed_thead = TRUE) %>%
  add_header_above(c(" "=1, "Sample Period" = 3, "Capture Timing" = 4,"Fork Length (mm)" = 4,
                     "Sample Period" = 3, "Capture Timing" = 4,"Fork Length (mm)" = 4)) %>%
  add_header_above(c(" " = 1,"Spring" = 11, "Fall" = 11)) 
 
```

```{r CT Size Distribution, length-frequency all years,echo=FALSE, warning=FALSE, message = FALSE}
## Length-Frequency Plot of all CCT captured to date.
    ## Prepare Data
    CT_dat <- data_all %>% 
                    filter(Species == "CT") %>%
                    mutate(date.std =  case_when(year(Date) >= 0 ~ 'year<-'(Date, 2024))) 
                    

      ## Prepare Plot
      all_years.plot <- ggplot(CT_dat) +
                            geom_histogram(aes(x = Length), binwidth = 5, color = "black", fill = "white") + 
                            labs(x = "Fork Lenght (mm)", y = "Frequency (# Fish)") +
                            scale_x_continuous(breaks = seq(50, 450, by = 25))+
                            #scale_y_continuous(breaks = seq(0, 450, 50))+
                            theme(axis.text.x = element_text(angle = 45, vjust = 1.2, hjust = 1)) +
                            theme_bw() +
                            facet_grid(Year~.)
```

```{r compare regional trends, echo=FALSE, warning=FALSE, message = FALSE}
## Prep Regional Abundance Dataset
reg.abund <- reg.dat %>% 
                mutate(data_set = "DFO") %>%
                select(data_set, year, species, spawners, smoothedSpawners) %>%
                rename(Year     = year,
                       Species  = species,
                       n        = spawners,
                       n_smooth = smoothedSpawners) %>% 
                mutate(Species = recode(as.factor(Species),
                                                 "Coho"      = "CO_Adult",
                                                 "Chinook"   = "CN",
                                                 "Pink"      = "PK",
                                                 "Chum"      = "CM",
                                                 "Sockeye"   = "SK",
                                                 "Steelhead" = "ST"),
                                Species = factor(Species, 
                                                 levels = c("CT","CO_Adult", "CN","CM","PK", "SK", "ST")))
# Prepare Simms Data and Join with Regional Data                
catch_spring <- data_all %>%
                    filter(Period == "Spring",
                           Species %in% c("CT", "CO")) %>%
                    group_by(Year,Species) %>%
                    summarise(n = n()) %>%
                    filter(!is.na(Species)) %>%
                    mutate(n_smooth = 0,
                           data_set = "Simms") %>% 
                    relocate(data_set) %>%
                rbind(reg.abund)

catch_spring_CO <- catch_spring %>%
      filter(Year >= 2008) %>%
      select(!n_smooth)

ggplot(catch_spring_CO, aes(x = Year, y = n)) +
  geom_point() + 
  geom_line() + 
  facet_grid(Species ~., scales = "free")

catch_spring_long <- catch_spring_CO %>%
      select(!data_set) %>%
      pivot_wider(names_from = Species, values_from = n) %>%
      drop_na()

cor(catch_spring_long)
```

# 3. Fall Fence Operation
### 3.1. Monitoring Effort

Fall surveys to count the number returning adult Coho, Chinook, Chum and Pink Salmon and also intercept a small number of Cutthroat Trout. In the fall, surveys have started as early as `r format(min(trap_plot$date.std[trap_plot$Period=="Fall"]), "%B %d")`, however, most surveys (50%) have started on `r format(min(trap_plot$date.std[trap_plot$Period=="Fall" & trap_plot$prop.sampled >= 0.5]), "%B %d")`. In each monitoring year, surveys have occurred continuously (e.g., sampling occurred daily) from `r format(min(trap_plot$date.std[trap_plot$Period=="Fall" & trap_plot$prop.sampled == 1.0]), "%B %d")` to `r format(max(trap_plot$date.std[trap_plot$Period=="Fall" & trap_plot$prop.sampled == 1.0]), "%B %d")`. Surveys have continued as late as `r format(max(trap_plot$date.std[trap_plot$Period =="Fall"]), "%B %d")` and no surveys have occurred later than `r format(max(trap_plot$date.std[trap_plot$Period=="Fall" & trap_plot$prop.sampled >= 0.5]), "%B %d")`.

## 3.2. Stream Conditions
During each trap daily trap visit, volunteers record measures of water temperature, pH, Total Suspended Sediment (TSS), dissolved oxygen, and water level (stage). Mean annual measures of each parameter are presented below for the Fall monitoring period (Table 2 and Figure 3).

```{r 3. Stream Conditions - Fall Table, fig.cap = "Table 3. Overall annual stream conditions during fall trap monitoring from 2008 to 2024.", fig.topcaption = TRUE,echo=FALSE, warning=FALSE, message = FALSE}

cond_data_wide.fall <- cond_data_wide %>% select(1,14:25)

## Kable - Stream Conditions ----
options(knitr.kable.NA = '-')
    

    kable(cond_data_wide.fall,
      "html",
      booktabs = T,
      
      align = c("c"),
      col.names = c(" ", "Mean","SD","Mean","SD","Mean","SD","Mean","SD","Mean","SD","Mean","SD"),
      caption = "Table 3. Stream conditions during fall trap operation.",
      
      digits = 1) %>%
  column_spec(c(2,5), width = "2cm") %>%
  kable_styling("striped", full_width =  FALSE,
                position = "center", 
                font_size = 12,
                fixed_thead = TRUE) %>% 
  add_header_above(c(" " = 1, "Air Temp. \n(\u00B0C)" = 2, "Water Temp. \n(\u00B0C)" = 2, 
                              "pH \n. " = 2, "DO \n(mg/L)" = 2, "TDS \n(ppm)" = 2, "Water Level \n(m)" = 2)) %>%
  add_header_above(c("Year"= 1, "Fall Monitoring" = 12))    



```

